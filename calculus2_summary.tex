\documentclass[unfonts,oneside,a4paper]{oblivoir}

\usepackage{kotex}
\usepackage{microtype}
\usepackage{bm}

\setcounter{secnumdepth}{4}
\renewcommand{\thesubsection}{\arabic{subsection}}

\usepackage{mathpazo}
\setmainfont{TeX Gyre Pagella}
\setmainhangulfont[ItalicFont={*},ItalicFeatures={FakeSlant=.167}]{NanumMyeongjo}
\usepackage{anyfontsize}

\usepackage{amsmath,mathtools,amssymb,amsthm,thmtools}

\theoremstyle{definition}
\newtheorem{definition}{정의}[subsubsection]

\theoremstyle{theorem}
\newtheorem{theorem}{정리}[subsubsection]

\usepackage{diffcoeff}
\diffset[roman = true]

\renewcommand{\vec}[1]{\bm{\mathit{#1}}}
\newcommand{\vecz}{\bm{\mathrm{0}}}
\newcommand{\dd}{\mathrm{d}}
\newcommand{\dD}{\mathrm{D}}
\DeclareMathOperator{\grad}{grad}

\title{수학 및 연습 2\\내용 요약}

\author{이재호\\\href{mailto:jaeho.lee@snu.ac.kr}{\texttt{jaeho.lee@snu.ac.kr}}}

\date{마지막 수정: \today}

\begin{document}

\maketitle

\setcounter{section}{9}
\section{다변수함수}
\subsection{그래프와 등위면}
\subsubsection{다변수함수}

\begin{definition}
    $n$-공간의 부분집합 $U$에서 정의된 함수
    \begin{equation*}
        f: U \rightarrow \mathbb R
    \end{equation*}
    가 주어졌다고 하자.
    즉, $U$의 각 점 $X = (x_1, \dots, x_n)$에 대하여 실수 $f(X) = f(x_1, \dots, x_n)$이 대응된다고 하자.
    이때 함수 $f$를 $n$변수함수라 하고, $n \geq 2$이면 다변수함수라고도 한다.
\end{definition}

\subsubsection{함수와 그래프}

\begin{definition}
    $n$-공간의 부분집합 $U$에서 정의된 다변수함수 $f$의 그래프는
    \begin{equation*}
        \{(x_1, \dots, x_n, z) \in \mathbb R^{n + 1} \mid (x_1, \dots, x_n) \in U,\ z = f(x_1, \dots, x_n)\}
    \end{equation*}
    으로 정의한다.
\end{definition}

\subsubsection{일차함수의 기울기}

\begin{definition}
    이변수 일차함수 $z = ax + by + c$의 기울기는 기울기 벡터
    \begin{equation*}
        (a, b) = a \vec i + b \vec j
    \end{equation*}
    로 나타낸다.
\end{definition}

\begin{theorem}
    단위벡터 $\vec v = (v_1, \dots, v_n)$에 대하여, 일차함수
    \begin{equation*}
        z = \vec a \cdot \vec x + c = a_1 x_1 + \dots + a_n x_n + c
    \end{equation*}
    의 $\vec v$-방향 기울기는
    \begin{equation*}
        \vec a \cdot \vec v = a_1 v_1 + \dots + a_n v_n
    \end{equation*}
    이다.
\end{theorem}

\begin{proof}
    일차함수 $z$의 $\vec v$-방향 기울기는
    \begin{equation*}
        \frac{z(\vec x + t \vec v) - z(\vec x)}{t} = \frac{(\vec a \cdot (\vec x + t \vec v) + c) - (\vec a \cdot \vec x + c)}{t} = \vec a \cdot \vec v
    \end{equation*}
    이다.
\end{proof}

\subsubsection{등위면}

\begin{definition}
    $n$-공간의 한 부분집합 $U$에서 정의된 다변수함수 $f: U \rightarrow \mathbb R$와 실수 $c$에 대하여, $f$에 대한 $c$의 역상(inverse image)
    \begin{equation*}
        f^{-1}(c) := \{X \in U \mid f(X) = c\}
    \end{equation*}
    를 $f$의 $c$-등위면(level surface) 또는 $c$-등가면이라고 부른다.
    즉, 등위면은 함숫값이 같은 점들의 모임이다.
\end{definition}

\subsection{연속함수}

\begin{definition}
    $n$-공간의 부분집합 $U$에서 정의된 함수 $f: U \rightarrow \mathbb R$와 $U$의 한 점 $P$에 대하여
    \begin{equation*}
        \lim_{X \rightarrow P} f(X) = f(P)
    \end{equation*}
    일 때, $f$는 점 $P$에서 연속이라고 정의한다.
    달리 쓰면,
    \begin{equation*}
        \lim_{X \rightarrow P} |f(X) - f(P)| = 0
    \end{equation*}
    이다.
\end{definition}

\subsubsection{연속함수}

\begin{definition}
    함수 $f: U \rightarrow \mathbb R$가 정의역 $U$의 모든 점에서 연속이면, $f$를 연속함수라고 한다.
\end{definition}

\subsubsection{최대최소 정리}
\paragraph{유계인 닫힌 집합}

\begin{definition}
    양수 $r$에 대하여 $n$-공간의 한 점 $P$를 중심으로 하고 반지름의 길이가 $r$인 열린 공(open ball)은
    \begin{equation*}
        \mathbb B^n (P, r) := \{X \in \mathbb R^n \mid |X - P| < r\}
    \end{equation*}
    를 뜻한다. 또  $n$-공간의 한 점 $P$를 중심으로 하고 반지름의 길이가 $r$인 닫힌 공(closed ball)은
    \begin{equation*}
        \overline{\mathbb B}^n (P, r) := \{X \in \mathbb R^n \mid |X - P| \leq r\}
    \end{equation*}
    를 뜻한다.
    
    열린 공 또는 닫힌 공을 그냥 공이라고 하고, 1차원 공은 구간, 2차원 공은 원판이다.
\end{definition}

\begin{definition}
    $n$-공간의 부분 집합 $U$가 유계(bounded)라는 것은 $U$를 포함하는 공이 존재한다는 뜻이다.
    이는 함수
    \begin{equation*}
        U \rightarrow \mathbb R,\quad X \mapsto |X|
    \end{equation*}
    가 유계 함수라는 것과 동치이다.
\end{definition}

\begin{definition}
    $n$-공간에서 경계를 포함하는 부분집합을 닫힌 집합이라고 부른다.
\end{definition}

\begin{theorem} [최대최소 정리]
    $n$-공간의 유계인 닫힌 집합에서 정의된 연속함수는 최댓값과 최솟값을 가진다.
\end{theorem}

\subsection{방향미분과 편미분}

\begin{definition}
    $n$-공간의 열린 집합 $U$에서 정의된 함수 $f: U \rightarrow \mathbb R$와 $U$의 한 점 $P$ 및 벡터 $\vec v$에 대하여, 극한값
    \begin{equation*}
        \dD_{\vec v} f(P) := \lim_{t \rightarrow 0} \frac{f(P + t \vec v) - f(P)}{t} = \diff*{}{t}{0} f(P + t \vec v)
    \end{equation*}
    가 존재하면 이 값을 점 $P$에서 $f$의 $\vec v$-방향미분계수 또는 $\vec v$-방향 순간변화율이라고 한다.
    단위벡터 $\vec v$에 대하여 $\vec v$-방향미분계수의 기하학적 의미는 함수 $f$의 그래프를 직선 $P + t \vec v$ 위에 한정하여 그렸을 때, 점 $(P, f(P))$에서 $f$의 그래프의 기울기를 뜻한다.
\end{definition}

\subsubsection{편도함수}

\begin{definition}
    $n$-공간의 표준단위벡터는
    \begin{equation*}
        \vec e_1 := (1, 0, \dots, 0),\quad\dots,\quad\vec e_n := (0, 0, \dots, 1)
    \end{equation*}
    을 말한다.
\end{definition}

\begin{definition}
    점 $P = (p_1, \dots, p_n)$에서 함수 $f: U \rightarrow \mathbb R$의 $\vec e_k$-방향미분계수 $\dD_{\vec e_k} f(P)$를 단순히
    \begin{equation*}
        \dD_k f(P)
    \end{equation*}
    로 쓰고, 점 $P$에서의 $f$의 $k$번째 편미분계수라고 한다.
    좌표의 성분을 써서 표시하면,
    \begin{equation*}
        \dD_k f(P) = \diff*{}{t}{0} f(p_1, \dots, p_k + t, \dots, p_n)
    \end{equation*}
    이다.
    이 값은 $P = (p_1, \dots, p_n)$의 $k$번째 성분만 변화시켜 얻은 변화율이다.
    이런 뜻에서 $\dD_k f(P)$를 $\diffp{f}{x_k} (P)$로 쓰기도 한다:
    \begin{equation*}
        \diffp{f}{x_k} := \dD_k f.
    \end{equation*}
    함수 $f$의 $k$번째 편미분계수 $\diffp{f}{x_k}$는 $k$번째 성분만을 변수로 하고, 나머지 변수는 상수로 보았을 때 얻은 미분계수이다.
\end{definition}

\begin{definition}
    함수 $f$가 정의역 $U$의 모든 점에 대하여 $k$번째 편미분계수를 가지면 함수
    \begin{equation*}
        \dD_k f: U \rightarrow \mathbb R,\quad P \mapsto \dD_k f(P)
    \end{equation*}
    를 $f$의 $k$번째 편도함수라고 한다.
\end{definition}

\subsubsection{기울기 벡터}

\begin{definition}
    $n$변수함수 $f$의 모든 편미분계수가 점 $P$에서 존재할 때, $f$는 점 $P$에서 편미분가능하다고 한다.
    이때 벡터
    \begin{equation*}
        \grad f(P) := (\dD_1 f(P), \dots, \dD_n f(P))
    \end{equation*}
    를 $P$에서 $f$의 그레이디언트 벡터(gradient vector) 또는 기울기 벡터라고 한다.

    일변수함수 $f(x)$의 그래프에서 접선의 기울기가 바로 $f'(x)$이듯이, 다변수 함수 $f(X)$의 그래프에서 ``접평면''의 기울기 벡터가 바로 $\grad f(P)$이다.

    $\grad f$를 $\nabla f$로 쓰기도 한다.
    즉
    \begin{equation*}
        \nabla = (\dD_1, \dots, \dD_n) = \left(\diffp*{}{x_1}, \dots, \diffp*{}{x_n}\right)
    \end{equation*}
    이다.
\end{definition}

\subsection{미분가능함수}

\begin{definition}
    $n$-공간의 원점 근방에서 정의된 두 함수 $g(\vec v)$, $h(\vec v)$에 대하여
    \begin{equation*}
        g(\vec v) = o(h(\vec v))
    \end{equation*}
    라는 것은 다음을 뜻한다:
    \begin{equation*}
        \forall \epsilon > 0 \quad \exists \delta > 0 \quad \forall \vec v \quad \bigl(0 < |\vec v| < \delta \Rightarrow |g(\vec v)| \leq \epsilon |h(\vec v)|\bigr)
    \end{equation*}
\end{definition}

\begin{definition}
    $n$-공간의 열린 집합 $U$에서 정의된 함수 $f: U \rightarrow \mathbb R$와 $U$의 점 $P$에 대하여
    \begin{equation} \label{eq:diff_def}
        \lim_{\vec v \rightarrow \vecz} \frac{|f(P + \vec v) - f(P) - \vec a \cdot \vec v|}{|\vec v|} = 0,
    \end{equation}
    즉
    \begin{equation} \label{eq:diff_alt_def}
        f(P + \vec v) = f(P) + \vec a \cdot \vec v + o(\vec v)
    \end{equation}
    를 만족시키는 벡터 $\vec a$가 존재하면 $f$는 점 $P$에서 미분가능하다고 한다.

    만약 $f$가 정의역의 모든 점에서 미분가능하면 $f$는 미분가능하다고 한다.
\end{definition}

\begin{theorem} \label{thm:grad_differential}
    $n$-공간의 열린 집합 $U$에서 정의된 함수 $f:U \rightarrow \mathbb R$가 점 $P \in U$에서 미분가능하면
    \begin{enumerate}
        \item $f$는 점 $P$에서 연속이다.
        \item $f$는 점 $P$에서 모든 방향의 방향미분계수를 가지고
            \begin{equation*}
                \dD_{\vec v} f(P) = \grad f(P) \cdot \vec v \quad (\vec v \in \mathbb R^n)
            \end{equation*}
            이다.
        \item 식~\ref{eq:diff_def}을 만족시키는 벡터 $\vec a$는 $\grad f(P)$이다.
    \end{enumerate}
\end{theorem}

\begin{proof}
    1. 식~\ref{eq:diff_alt_def}에서
    \begin{equation*}
        \lim_{\vec v \rightarrow \vecz} f(P + \vec v) = \lim_{\vec v \rightarrow \vecz} \bigl(f(P) + \vec a \cdot \vec v + o(\vec v)\bigr) = f(P)
    \end{equation*}
    이다.

    2, 3. 식~\ref{eq:diff_def}에 의하면, 어떤 벡터 $\vec v$에 대하여
    \begin{equation*}
        \lim_{|t \vec v| \rightarrow 0} \frac{|f(P + t \vec v) - f(P) - \vec a \cdot t \vec v|}{|t \vec v|} = 0
    \end{equation*}
    을 만족한다.
    즉,
    \begin{equation*}
        \frac{1}{|\vec v|} \lim_{t \rightarrow 0} \frac{f(P + t \vec v) - f(P) - \vec a \cdot t \vec v}{t} = \frac{1}{|\vec v|} \lim_{t \rightarrow 0} \frac{f(P + t \vec v) - f(P)}{t} - \vec a \cdot \frac{\vec v}{|\vec v|} = 0
    \end{equation*}
    이다.
    따라서 방향미분 $\dD_{\vec v} f(P)$가 존재하고
    \begin{equation*}
        \dD_{\vec v} f(P) = \lim_{t \rightarrow 0} \frac{f(P + t \vec v) - f(P)}{t} = \vec a \cdot \vec v
    \end{equation*}
    이다.

    이제 $\vec a = (a_1, \dots, a_n)$으로 두면
    \begin{equation*}
        \dD_i f(P) = \dD_{\vec e_i} f(P) = \vec a \cdot \vec e_i = a_i
    \end{equation*}
    이고
    \begin{equation*}
        \grad f(P) = \bigl(\dD_1 f(P), \dots, \dD_n f(P)\bigr) = (a_1, \dots, a_n) = \vec a
    \end{equation*}
    이다.
    따라서
    \begin{equation*}
        \dD_{\vec v} f(P) = \vec a \cdot \vec v = \grad f(P) \cdot \vec v
    \end{equation*}
    이다.
\end{proof}

따라서, 함수 $f$가 점 $P$에서 미분가능할 필요충분조건은
\begin{enumerate}
    \item $\grad f(P)$가 존재하고
    \item $f(P + \vec v) - f(P) = \grad f(P) \cdot \vec v + o(\vec v)$
\end{enumerate}
인 것이다.
따라서 기울기 벡터 $\grad f(P)$를 점 $P$에서 $f$의 미분계수라고 하고, $f'(P)$ 또는 $\dD f(P)$로 쓰기도 한다.

\subsubsection{기울기 벡터와 함수의 변화율}
정리~\ref{thm:grad_differential}에서 $\vec v$가 단위벡터이고, $\vec v$와 $\grad f(P)$가 이루는 각의 크기가 $\theta$라면,
\begin{equation*}
    \dD_{\vec v} f(P) = \grad f(P) \cdot \vec v = |\grad f(P)| \cos \theta
\end{equation*}
이므로, $\dD_{\vec v} f(P)$가 최대가 되는 단위벡터 $\vec v$는 $\cos \theta = 1$인 벡터, 즉 $\grad f(P)$와 같은 방향의 단위벡터이다.
이때 $\grad f(P)$의 크기가 $\vec v$-방향 변화율이다.
이러한 원리에서 $\grad f(P) = \left(\diffp{f}{x_1}(P), \dots, \diffp{f}{x_n}(P)\right)$는 좌표계의 선택과 무관함을 알 수 있다.
또 $\dD_{\vec v} f(P)$가 최소가 되는 단위벡터 $\vec v$는 $\cos \theta = -1$인 벡터, 즉 $\vec v$가 $- \grad f(P)$와 같은 방향의 단위벡터임을 안다.
같은 이유에서 $\grad f(P)$와 수직인 방향으로의 순간변화율은 $0$이다.

\subsubsection{일급미분가능함수}

\begin{definition}
    $n$-공간의 한 열린 집합에서 정의된 함수 $f(x_1, \dots, x_n)$의 각 편도함수
    \begin{equation*}
        \diffp{f}{x_1},\quad\dots,\quad \diffp{f}{x_n}
    \end{equation*}
    이 모두 연속함수이면, $f$를 일급함수 또는 $\mathcal C^1$ 함수라고 한다.
\end{definition}

\begin{theorem}
    $n$-공간의 열린 집합에서 정의된 일급함수는 미분가능 함수이다.
\end{theorem}

\subsection{연쇄법칙}

\begin{theorem}[연쇄법칙]
    $n$-공간의 열린 집합 $U$에서 정의된 미분가능한 함수 $f$와 구간 $I$에서 정의된 미분가능한 곡선 $X: I \rightarrow U$에 대하여 다음이 성립한다:
    \begin{equation*}
        \forall t \in I \qquad \diff*{f(X(t))}{t} = \grad f(X(t)) \cdot X'(t)
    \end{equation*}
\end{theorem}

\begin{proof}
    먼저 $t \in I$를 고정하면, 절댓값이 아주 작은 실수 $\Delta t$에 대하여
    \begin{align*}
        &\hphantom{=\ \ } f\bigl(X(t + \Delta t)\bigr) - f\bigl(X(t)\bigr)\\
        &= \grad f\bigl(X(t)\bigr) \cdot \bigl(X(t + \Delta t) - X(t)\bigr) + o(|X(t + \Delta t) - X(t)|)\\
        &= \grad f\bigl(X(t)\bigr) \cdot \bigl(X'(t)\Delta t o(\Delta t)\bigr) + o(\Delta t)\\
        &= \grad f\bigl(X(t)\bigr) \cdot X'(t) \Delta t + o(\Delta t)
    \end{align*}
    이므로 원하는 결론을 얻는다.
\end{proof}

연쇄법칙을 좌표의 성분을 써서 표현하면
\begin{equation*}
    \diff*{f\bigl(x_1(t), \dots, x_n(t)\bigr)}{t} = \diffp{f}{x_1} \diff{x_1}{t} + \dots + \diffp{f}{x_n} \diff{x_n}{t}
\end{equation*}
이다. 만약 $X = (x_1, \dots, x_n)$가 두 개의 변수 $s, t$에 의존하면, 연쇄법칙은
\begin{align*}
    \diffp*{f\bigl(x_1(s, t), \dots, x_n(s, t)\bigr)}{s} &= \diffp{f}{x_1} \diffp{x_1}{s} + \dots + \diffp{f}{x_n} \diffp{x_n}{s}\\
    \diffp*{f\bigl(x_1(s, t), \dots, x_n(s, t)\bigr)}{t} &= \diffp{f}{x_1} \diffp{x_1}{t} + \dots + \diffp{f}{x_n} \diffp{x_n}{t}
\end{align*}
으로 표현된다.

\subsection{기울기 벡터와 등위면}

\begin{theorem}
    $n$-공간의 열린 집합 $U$에서 정의된 일급함수 $f$에 대하여 점 $P$에서 기울기 벡터 $\grad f(P)$는 점 $P$가 속하는 등위면 $S := \{X \in U \mid f(X) = f(P)\}$에 수직이다.
\end{theorem}

\begin{proof}
    점 $P$에서 등위면 $S$의 접평면은 $P$를 지나는 $S$ 속의 곡선들의 접선들로 이루어져 있다.
    다시 말하면 미분가능한 곡선
    \begin{equation*}
        X: \mathbb R \rightarrow S, \qquad X(0) = P
    \end{equation*}
    에 대하여 속도벡터 $X'(0)$은 점 $P$에서 $S$의 접평면에 속하고, 역으로 접평면의 원소들은 모두 이러한 방법으로 얻어진다.
    따라서 이러한 곡선 $X$에 대하여
    \begin{equation*}
        \grad f(P) \cdot X'(0) = 0
    \end{equation*}
    그런데 $X(t) \in S$이므로 $f(X(t)) = f(P)$이다.
    이를 $t$에 대하여 미분하면, 연쇄법칙 덕분에 $\grad f(X(t)) \cdot X'(t) = 0$임을 안다.
    이제 $t = 0$을 대입하여 원하는 결론을 얻는다.
\end{proof}
\end{document}
