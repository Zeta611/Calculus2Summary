\documentclass[unfonts,oneside,a4paper]{oblivoir}

\usepackage{kotex}
\usepackage{microtype}
\usepackage{bm}

\setcounter{secnumdepth}{4}

\usepackage{mathpazo}
\setmainfont{TeX Gyre Pagella}
\setmainhangulfont[ItalicFont={*},ItalicFeatures={FakeSlant=.167}]{NanumMyeongjo}
\usepackage{anyfontsize}

\usepackage{amsmath,mathtools,amssymb,amsthm,thmtools}

\theoremstyle{definition}
\newtheorem{definition}{정의}[subsubsection]

\theoremstyle{theorem}
\newtheorem{theorem}{정리}[subsubsection]
\newtheorem{corollary}{따름정리}[subsubsection]
\newtheorem{lemma}{도움정리}[subsubsection]

\renewcommand*{\proofname}{증명}

\usepackage{diffcoeff}
\diffset[roman = true]

\renewcommand{\vec}[1]{\bm{\mathit{#1}}}
\newcommand{\vecz}{\bm{\mathrm{0}}}
\newcommand{\dd}{\mathrm{d}}
\newcommand{\dD}{\mathrm{D}}
\DeclareMathOperator{\grad}{grad}

\title{수학 및 연습 2\\내용 요약}

\author{이재호\\\href{mailto:jaeho.lee@snu.ac.kr}{\texttt{jaeho.lee@snu.ac.kr}}}

\date{마지막 수정: \today}

\begin{document}

\maketitle

\setcounter{section}{9}
\section{다변수함수}
\subsection{그래프와 등위면}
\subsubsection{다변수함수}

\begin{definition}
    $n$-공간의 부분집합 $U$에서 정의된 함수
    \begin{equation*}
        f: U \rightarrow \mathbb R
    \end{equation*}
    가 주어졌다고 하자.
    즉, $U$의 각 점 $X = (x_1, \dots, x_n)$에 대하여 실수 $f(X) = f(x_1, \dots, x_n)$이 대응된다고 하자.
    이때 함수 $f$를 $n$변수함수라 하고, $n \geq 2$이면 다변수함수라고도 한다.
\end{definition}

\subsubsection{함수와 그래프}

\begin{definition}
    $n$-공간의 부분집합 $U$에서 정의된 다변수함수 $f$의 그래프는
    \begin{equation*}
        \{(x_1, \dots, x_n, z) \in \mathbb R^{n + 1} \mid (x_1, \dots, x_n) \in U,\ z = f(x_1, \dots, x_n)\}
    \end{equation*}
    으로 정의한다.
\end{definition}

\subsubsection{일차함수의 기울기}

\begin{definition}
    이변수 일차함수 $z = ax + by + c$의 기울기는 기울기 벡터
    \begin{equation*}
        (a, b) = a \vec i + b \vec j
    \end{equation*}
    로 나타낸다.
\end{definition}

\begin{theorem}
    단위벡터 $\vec v = (v_1, \dots, v_n)$에 대하여, 일차함수
    \begin{equation*}
        z = \vec a \cdot \vec x + c = a_1 x_1 + \dots + a_n x_n + c
    \end{equation*}
    의 $\vec v$-방향 기울기는
    \begin{equation*}
        \vec a \cdot \vec v = a_1 v_1 + \dots + a_n v_n
    \end{equation*}
    이다.
\end{theorem}

\begin{proof}
    일차함수 $z$의 $\vec v$-방향 기울기는
    \begin{equation*}
        \frac{z(\vec x + t \vec v) - z(\vec x)}{t} = \frac{(\vec a \cdot (\vec x + t \vec v) + c) - (\vec a \cdot \vec x + c)}{t} = \vec a \cdot \vec v
    \end{equation*}
    이다.
\end{proof}

\subsubsection{등위면}

\begin{definition}
    $n$-공간의 한 부분집합 $U$에서 정의된 다변수함수 $f: U \rightarrow \mathbb R$와 실수 $c$에 대하여, $f$에 대한 $c$의 역상(inverse image)
    \begin{equation*}
        f^{-1}(c) := \{X \in U \mid f(X) = c\}
    \end{equation*}
    를 $f$의 $c$-등위면(level surface) 또는 $c$-등가면이라고 부른다.
    즉, 등위면은 함숫값이 같은 점들의 모임이다.
\end{definition}

\subsection{연속함수}

\begin{definition}
    $n$-공간의 부분집합 $U$에서 정의된 함수 $f: U \rightarrow \mathbb R$와 $U$의 한 점 $P$에 대하여
    \begin{equation*}
        \lim_{X \rightarrow P} f(X) = f(P)
    \end{equation*}
    일 때, $f$는 점 $P$에서 연속이라고 정의한다.
    달리 쓰면,
    \begin{equation*}
        \lim_{X \rightarrow P} |f(X) - f(P)| = 0
    \end{equation*}
    이다.
\end{definition}

\subsubsection{연속함수}

\begin{definition}
    함수 $f: U \rightarrow \mathbb R$가 정의역 $U$의 모든 점에서 연속이면, $f$를 연속함수라고 한다.
\end{definition}

\subsubsection{최대최소 정리}
\paragraph{유계인 닫힌 집합}

\begin{definition}
    양수 $r$에 대하여 $n$-공간의 한 점 $P$를 중심으로 하고 반지름의 길이가 $r$인 열린 공(open ball)은
    \begin{equation*}
        \mathbb B^n (P, r) := \{X \in \mathbb R^n \mid |X - P| < r\}
    \end{equation*}
    를 뜻한다. 또  $n$-공간의 한 점 $P$를 중심으로 하고 반지름의 길이가 $r$인 닫힌 공(closed ball)은
    \begin{equation*}
        \overline{\mathbb B}^n (P, r) := \{X \in \mathbb R^n \mid |X - P| \leq r\}
    \end{equation*}
    를 뜻한다.
    
    열린 공 또는 닫힌 공을 그냥 공이라고 하고, 1차원 공은 구간, 2차원 공은 원판이다.
\end{definition}

\begin{definition}
    $n$-공간의 부분 집합 $U$가 유계(bounded)라는 것은 $U$를 포함하는 공이 존재한다는 뜻이다.
    이는 함수
    \begin{equation*}
        U \rightarrow \mathbb R,\quad X \mapsto |X|
    \end{equation*}
    가 유계 함수라는 것과 동치이다.
\end{definition}

\begin{definition}
    $n$-공간에서 경계를 포함하는 부분집합을 닫힌 집합이라고 부른다.
\end{definition}

\begin{theorem} [최대최소 정리]
    $n$-공간의 유계인 닫힌 집합에서 정의된 연속함수는 최댓값과 최솟값을 가진다.
\end{theorem}

\subsection{방향미분과 편미분}

\begin{definition}
    $n$-공간의 열린 집합 $U$에서 정의된 함수 $f: U \rightarrow \mathbb R$와 $U$의 한 점 $P$ 및 벡터 $\vec v$에 대하여, 극한값
    \begin{equation*}
        \dD_{\vec v} f(P) := \lim_{t \rightarrow 0} \frac{f(P + t \vec v) - f(P)}{t} = \diff*{}{t}{0} f(P + t \vec v)
    \end{equation*}
    가 존재하면 이 값을 점 $P$에서 $f$의 $\vec v$-방향미분계수 또는 $\vec v$-방향 순간변화율이라고 한다.
    단위벡터 $\vec v$에 대하여 $\vec v$-방향미분계수의 기하학적 의미는 함수 $f$의 그래프를 직선 $P + t \vec v$ 위에 한정하여 그렸을 때, 점 $(P, f(P))$에서 $f$의 그래프의 기울기를 뜻한다.
\end{definition}

\subsubsection{편도함수}

\begin{definition}
    $n$-공간의 표준단위벡터는
    \begin{equation*}
        \vec e_1 := (1, 0, \dots, 0),\quad\dots,\quad\vec e_n := (0, 0, \dots, 1)
    \end{equation*}
    을 말한다.
\end{definition}

\begin{definition}
    점 $P = (p_1, \dots, p_n)$에서 함수 $f: U \rightarrow \mathbb R$의 $\vec e_k$-방향미분계수 $\dD_{\vec e_k} f(P)$를 단순히
    \begin{equation*}
        \dD_k f(P)
    \end{equation*}
    로 쓰고, 점 $P$에서의 $f$의 $k$번째 편미분계수라고 한다.
    좌표의 성분을 써서 표시하면,
    \begin{equation*}
        \dD_k f(P) = \diff*{}{t}{0} f(p_1, \dots, p_k + t, \dots, p_n)
    \end{equation*}
    이다.
    이 값은 $P = (p_1, \dots, p_n)$의 $k$번째 성분만 변화시켜 얻은 변화율이다.
    이런 뜻에서 $\dD_k f(P)$를 $\diffp{f}{x_k} (P)$로 쓰기도 한다:
    \begin{equation*}
        \diffp{f}{x_k} := \dD_k f.
    \end{equation*}
    함수 $f$의 $k$번째 편미분계수 $\diffp{f}{x_k}$는 $k$번째 성분만을 변수로 하고, 나머지 변수는 상수로 보았을 때 얻은 미분계수이다.
\end{definition}

\begin{definition}
    함수 $f$가 정의역 $U$의 모든 점에 대하여 $k$번째 편미분계수를 가지면 함수
    \begin{equation*}
        \dD_k f: U \rightarrow \mathbb R,\quad P \mapsto \dD_k f(P)
    \end{equation*}
    를 $f$의 $k$번째 편도함수라고 한다.
\end{definition}

\subsubsection{기울기 벡터}

\begin{definition}
    $n$변수함수 $f$의 모든 편미분계수가 점 $P$에서 존재할 때, $f$는 점 $P$에서 편미분가능하다고 한다.
    이때 벡터
    \begin{equation*}
        \grad f(P) := (\dD_1 f(P), \dots, \dD_n f(P))
    \end{equation*}
    를 $P$에서 $f$의 그레이디언트 벡터(gradient vector) 또는 기울기 벡터라고 한다.

    일변수함수 $f(x)$의 그래프에서 접선의 기울기가 바로 $f'(x)$이듯이, 다변수 함수 $f(X)$의 그래프에서 ``접평면''의 기울기 벡터가 바로 $\grad f(P)$이다.

    $\grad f$를 $\nabla f$로 쓰기도 한다.
    즉
    \begin{equation*}
        \nabla = (\dD_1, \dots, \dD_n) = \left(\diffp*{}{x_1}, \dots, \diffp*{}{x_n}\right)
    \end{equation*}
    이다.
\end{definition}

\subsection{미분가능함수}

\begin{definition}
    $n$-공간의 원점 근방에서 정의된 두 함수 $g(\vec v)$, $h(\vec v)$에 대하여
    \begin{equation*}
        g(\vec v) = o(h(\vec v))
    \end{equation*}
    라는 것은 다음을 뜻한다:
    \begin{equation*}
        \forall \epsilon > 0 \quad \exists \delta > 0 \quad \forall \vec v \quad \bigl(0 < |\vec v| < \delta \Rightarrow |g(\vec v)| \leq \epsilon |h(\vec v)|\bigr)
    \end{equation*}
\end{definition}

\begin{definition}
    $n$-공간의 열린 집합 $U$에서 정의된 함수 $f: U \rightarrow \mathbb R$와 $U$의 점 $P$에 대하여
    \begin{equation} \label{eq:diff_def}
        \lim_{\vec v \rightarrow \vecz} \frac{|f(P + \vec v) - f(P) - \vec a \cdot \vec v|}{|\vec v|} = 0,
    \end{equation}
    즉
    \begin{equation} \label{eq:diff_alt_def}
        f(P + \vec v) = f(P) + \vec a \cdot \vec v + o(\vec v)
    \end{equation}
    를 만족시키는 벡터 $\vec a$가 존재하면 $f$는 점 $P$에서 미분가능하다고 한다.

    만약 $f$가 정의역의 모든 점에서 미분가능하면 $f$는 미분가능하다고 한다.
\end{definition}

\begin{theorem} \label{thm:grad_differential}
    $n$-공간의 열린 집합 $U$에서 정의된 함수 $f:U \rightarrow \mathbb R$가 점 $P \in U$에서 미분가능하면
    \begin{enumerate}
        \item $f$는 점 $P$에서 연속이다.
        \item $f$는 점 $P$에서 모든 방향의 방향미분계수를 가지고
            \begin{equation*}
                \dD_{\vec v} f(P) = \grad f(P) \cdot \vec v \quad (\vec v \in \mathbb R^n)
            \end{equation*}
            이다.
        \item 식~\ref{eq:diff_def}을 만족시키는 벡터 $\vec a$는 $\grad f(P)$이다.
    \end{enumerate}
\end{theorem}

\begin{proof}
    1. 식~\ref{eq:diff_alt_def}에서
    \begin{equation*}
        \lim_{\vec v \rightarrow \vecz} f(P + \vec v) = \lim_{\vec v \rightarrow \vecz} \bigl(f(P) + \vec a \cdot \vec v + o(\vec v)\bigr) = f(P)
    \end{equation*}
    이다.

    2, 3. 식~\ref{eq:diff_def}에 의하면, 어떤 벡터 $\vec v$에 대하여
    \begin{equation*}
        \lim_{|t \vec v| \rightarrow 0} \frac{|f(P + t \vec v) - f(P) - \vec a \cdot t \vec v|}{|t \vec v|} = 0
    \end{equation*}
    을 만족한다.
    즉,
    \begin{equation*}
        \frac{1}{|\vec v|} \lim_{t \rightarrow 0} \frac{f(P + t \vec v) - f(P) - \vec a \cdot t \vec v}{t} = \frac{1}{|\vec v|} \lim_{t \rightarrow 0} \frac{f(P + t \vec v) - f(P)}{t} - \vec a \cdot \frac{\vec v}{|\vec v|} = 0
    \end{equation*}
    이다.
    따라서 방향미분 $\dD_{\vec v} f(P)$가 존재하고
    \begin{equation*}
        \dD_{\vec v} f(P) = \lim_{t \rightarrow 0} \frac{f(P + t \vec v) - f(P)}{t} = \vec a \cdot \vec v
    \end{equation*}
    이다.

    이제 $\vec a = (a_1, \dots, a_n)$으로 두면
    \begin{equation*}
        \dD_i f(P) = \dD_{\vec e_i} f(P) = \vec a \cdot \vec e_i = a_i
    \end{equation*}
    이고
    \begin{equation*}
        \grad f(P) = \bigl(\dD_1 f(P), \dots, \dD_n f(P)\bigr) = (a_1, \dots, a_n) = \vec a
    \end{equation*}
    이다.
    따라서
    \begin{equation*}
        \dD_{\vec v} f(P) = \vec a \cdot \vec v = \grad f(P) \cdot \vec v
    \end{equation*}
    이다.
\end{proof}

따라서, 함수 $f$가 점 $P$에서 미분가능할 필요충분조건은
\begin{enumerate}
    \item $\grad f(P)$가 존재하고
    \item $f(P + \vec v) - f(P) = \grad f(P) \cdot \vec v + o(\vec v)$
\end{enumerate}
인 것이다.
따라서 기울기 벡터 $\grad f(P)$를 점 $P$에서 $f$의 미분계수라고 하고, $f'(P)$ 또는 $\dD f(P)$로 쓰기도 한다.

\subsubsection{기울기 벡터와 함수의 변화율}
정리~\ref{thm:grad_differential}에서 $\vec v$가 단위벡터이고, $\vec v$와 $\grad f(P)$가 이루는 각의 크기가 $\theta$라면,
\begin{equation*}
    \dD_{\vec v} f(P) = \grad f(P) \cdot \vec v = |\grad f(P)| \cos \theta
\end{equation*}
이므로, $\dD_{\vec v} f(P)$가 최대가 되는 단위벡터 $\vec v$는 $\cos \theta = 1$인 벡터, 즉 $\grad f(P)$와 같은 방향의 단위벡터이다.
이때 $\grad f(P)$의 크기가 $\vec v$-방향 변화율이다.
이러한 원리에서 $\grad f(P) = \left(\diffp{f}{x_1}(P), \dots, \diffp{f}{x_n}(P)\right)$는 좌표계의 선택과 무관함을 알 수 있다.
또 $\dD_{\vec v} f(P)$가 최소가 되는 단위벡터 $\vec v$는 $\cos \theta = -1$인 벡터, 즉 $\vec v$가 $- \grad f(P)$와 같은 방향의 단위벡터임을 안다.
같은 이유에서 $\grad f(P)$와 수직인 방향으로의 순간변화율은 $0$이다.

\subsubsection{일급미분가능함수}

\begin{definition}
    $n$-공간의 한 열린 집합에서 정의된 함수 $f(x_1, \dots, x_n)$의 각 편도함수
    \begin{equation*}
        \diffp{f}{x_1},\quad\dots,\quad \diffp{f}{x_n}
    \end{equation*}
    이 모두 연속함수이면, $f$를 일급함수 또는 $\mathcal C^1$ 함수라고 한다.
\end{definition}

\begin{theorem}
    $n$-공간의 열린 집합에서 정의된 일급함수는 미분가능 함수이다.
\end{theorem}

\subsection{연쇄법칙}

\begin{theorem}[연쇄법칙]
    $n$-공간의 열린 집합 $U$에서 정의된 미분가능한 함수 $f$와 구간 $I$에서 정의된 미분가능한 곡선 $X: I \rightarrow U$에 대하여 다음이 성립한다:
    \begin{equation*}
        \forall t \in I \qquad \diff*{f(X(t))}{t} = \grad f(X(t)) \cdot X'(t)
    \end{equation*}
\end{theorem}

\begin{proof}
    먼저 $t \in I$를 고정하면, 절댓값이 아주 작은 실수 $\Delta t$에 대하여
    \begin{align*}
        &\hphantom{=\ \ } f\bigl(X(t + \Delta t)\bigr) - f\bigl(X(t)\bigr)\\
        &= \grad f\bigl(X(t)\bigr) \cdot \bigl(X(t + \Delta t) - X(t)\bigr) + o(|X(t + \Delta t) - X(t)|)\\
        &= \grad f\bigl(X(t)\bigr) \cdot \bigl(X'(t)\Delta t + o(\Delta t)\bigr) + o(\Delta t)\\
        &= \grad f\bigl(X(t)\bigr) \cdot X'(t) \Delta t + o(\Delta t)
    \end{align*}
    이므로 원하는 결론을 얻는다.
\end{proof}

연쇄법칙을 좌표의 성분을 써서 표현하면
\begin{equation*}
    \diff*{f\bigl(x_1(t), \dots, x_n(t)\bigr)}{t} = \diffp{f}{x_1} \diff{x_1}{t} + \dots + \diffp{f}{x_n} \diff{x_n}{t}
\end{equation*}
이다. 만약 $X = (x_1, \dots, x_n)$가 두 개의 변수 $s, t$에 의존하면, 연쇄법칙은
\begin{align*}
    \diffp*{f\bigl(x_1(s, t), \dots, x_n(s, t)\bigr)}{s} &= \diffp{f}{x_1} \diffp{x_1}{s} + \dots + \diffp{f}{x_n} \diffp{x_n}{s}\\
    \diffp*{f\bigl(x_1(s, t), \dots, x_n(s, t)\bigr)}{t} &= \diffp{f}{x_1} \diffp{x_1}{t} + \dots + \diffp{f}{x_n} \diffp{x_n}{t}
\end{align*}
으로 표현된다.

\subsection{기울기 벡터와 등위면}

\begin{theorem}
    $n$-공간의 열린 집합 $U$에서 정의된 일급함수 $f$에 대하여 점 $P$에서 기울기 벡터 $\grad f(P)$는 점 $P$가 속하는 등위면 $S := \{X \in U \mid f(X) = f(P)\}$에 수직이다.
\end{theorem}

\begin{proof}
    점 $P$에서 등위면 $S$의 접평면은 $P$를 지나는 $S$ 속의 곡선들의 접선들로 이루어져 있다.
    다시 말하면 미분가능한 곡선
    \begin{equation*}
        X: \mathbb R \rightarrow S, \qquad X(0) = P
    \end{equation*}
    에 대하여 속도벡터 $X'(0)$은 점 $P$에서 $S$의 접평면에 속하고, 역으로 접평면의 원소들은 모두 이러한 방법으로 얻어진다.
    따라서 이러한 곡선 $X$에 대하여
    \begin{equation*}
        \grad f(P) \cdot X'(0) = 0
    \end{equation*}
    그런데 $X(t) \in S$이므로 $f(X(t)) = f(P)$이다.
    이를 $t$에 대하여 미분하면, 연쇄법칙 덕분에 $\grad f(X(t)) \cdot X'(t) = 0$임을 안다.
    이제 $t = 0$을 대입하여 원하는 결론을 얻는다.
\end{proof}

\section{최대최소 문제와 고계미분}
\subsection{적분기호 속의 미분법}

\begin{theorem}[라이프니츠 정리]
    직사각형 $[a, b] \times [c, d]$에서 정의된 일급함수 $f(x, y)$에 대하여 등식
    \begin{equation*}
        \diff*{\int_c^d f(x, y)\,\dd y}{x} = \int_c^d \diffp{f}{x} (x, y)\,\dd y
    \end{equation*}
\end{theorem}

\subsection{이계미분}

\begin{definition}
    $n$-공간의 열린집합 $U$에서 정의된 일급함수 $f$의 일계 편도함수
    \begin{equation*}
        \dD_1 f, \dots, \dD_n f: U \rightarrow \mathbb R
    \end{equation*}
    가 모두
    \begin{enumerate}
        \item 미분가능함수이면, $f$를 두번 미분가능한 함수
        \item 일급함수이면, $f$를 이급함수 또는 $\mathcal C^2$ 함수
    \end{enumerate}
    라고 한다.
    물론 이급함수는 두번 미분가능한 함수이다.

    이때 $f$는 점 $P \in U$에서 모두 $n^2$개의 이계 편미분계수
    \begin{equation*}
        \dD_i \dD_j f(P) = \diffp{f}{x_i, x_j}
    \end{equation*}
    를 가진다.
    $\dD_i \dD_i f$는 줄여서 $\dD_i^2 f$로 쓰기로 한다.
\end{definition}

\begin{theorem}[편미분 교환법칙]
    $n$-공간의 열린집합에서 정의된 이급함수 (혹은 단지 두번 미분가능한 함수) $f$와 정의역의 임의의 점 $P$에 대하여
    \begin{equation*}
        \dD_i \dD_j f(P) = \dD_j \dD_i f(P) \qquad (1 \leq i, j \leq n)
    \end{equation*}
    이다.
\end{theorem}

\begin{proof}
    $i$번째 변수와 $j$번째 변수 사이의 관계를 조사하므로 이변수함수 $f(x, y)$에 대하여 밝히면 된다.
    먼저 정의역에 포함되는 조그만 직사각형 $[a, b] \times [c, d]$ 속에서
    \begin{align*}
        \int_c^u \dD_i \dD_j f(x, t)\,\dd t &= \diffp*{\int_c^y \dD_2 f(x, t)\, \dd t}{x}\\
                                            &= \diffp*{\bigl(f(x, y) - f(x, c)\bigr)}{x}\\
                                            &= \dD_1 f(x, y) - \dD_1 f(x, c)
    \end{align*}
    를 얻는다.
    한편 이 식의 왼쪽항이 $y$에 대하여 미분가능하고 따라서 오른쪽항도 $y$에 대하여 미분가능하며, 이로부터 양변을 $y$로 미분하면
    \begin{equation*}
        \dD_1 \dD_2 f(x, y) = \dD_2 \dD_1 f(x, y)
    \end{equation*}
    를 얻는다.
\end{proof}

\begin{corollary}
    $n$-공간의 열린집합에서 정의된 $k$급함수 $f$의 고계편도함수
    \begin{equation*}
        \dD_{i_1} \dD_{i_2} \dots \dD_{i_k} f \qquad (1 \leq i_1, i_2, \dots, i_k \leq n)
    \end{equation*}
    는 $\dD_{i_1}, \dD_{i_2}, \dots, \dD_{i_k}$의 순서를 바꾸어도 변화가 없다.
\end{corollary}

\subsubsection{방향미분작용소}
일급함수 $f(x_1, \dots, x_n)$와 벡터 $\vec v = v_1 \vec e_1 + \dots + v_n \vec e_n$에 대하여
\begin{equation*}
    \dD_{\vec v} f = \vec v \cdot \grad f = (v_1 \dD_1 + \dots + v_n \dD_n) f
\end{equation*}
임을 알고 있다.
이 식을
\begin{equation*}
    \dD_{\vec v} = v_1 \dD_1 + \dots + v_n \dD_n
\end{equation*}
으로 쓰기로 한다.

$f$가 이급이면
\begin{equation*}
    \dD_{\vec v}^2 = \left(\sum_{i = 1}^n v_i \dD_i \right)^2 = \sum_{i, j = 1}^n v_i v_j \dD_i \dD_j
\end{equation*}
이다.
이차원에서는 벡터 $\vec v = a \vec i + b \vec j = (a, b)$에 대하여
\begin{equation*}
    \dD_{(a, b)}^2 = a^2 \dD_1^2 + 2ab \dD_1 \dD_2 + b^2 \dD_2^2
\end{equation*}
을 얻는다.

함수의 일계미분계수가 함수의 순간변화율 또는 ``기울기''를 나타내듯이 함수의 이계미분계수는 함수의 오목$\cdot$볼록성을 말하여 준다.
다변수함수인 경우에는 오목$\cdot$볼록성을 조사하기 위하여 여전히 방향이 주어져야 하고, 이때 $\vec v$-방향 이계미분계수는
\begin{equation*}
    \dD_{\vec v}^2 f(P)
\end{equation*}
이다.

\begin{lemma} \label{lem:second_ord}
    $n$-공간의 열린 집합에서 정의된 이급함수 $f$와 정의역의 임의의 점 $P$ 및 벡터 $\vec v$에 대하여
    \begin{equation*}
        \diff*[2]{}{t}{0} f(P + t \vec v) = \dD_{\vec v}^2 f(P)
    \end{equation*}
    이다.
\end{lemma}

\begin{proof}
    연쇄법칙에서
    \begin{equation*}
        \diff*{f(P + t \vec v)}{t} = \grad f(P + t \vec v) \cdot \vec v = \dD_{\vec v} f(P + t \vec v)
    \end{equation*}
    임을 안다.
    따라서
    \begin{equation*}
        \diff*[2]{f(P+ t \vec v)}{t} = \diff*{(\dD_{\vec v}f)}{t} (P + t \vec v) = \dD_{\vec v} (\dD_{\vec v}f)(P + t \vec v)
    \end{equation*}
    이다.
    이제 $t = 0$으로 두면 원하는 결론을 얻는다.
\end{proof}

이 정리에서
\begin{align*}
    \dD_{\vec v}^2 f(P) > 0 \text{이면, $f$는 점 $P$에서 $\vec v$방향으로 볼록}\\
    \dD_{\vec v}^2 f(P) < 0 \text{이면, $f$는 점 $P$에서 $\vec v$방향으로 오목}
\end{align*}
임을 안다.

\subsubsection{고계미분계수}
함수 $f(x, y)$가 삼급함수이면 벡터 $\vec v = (a, b)$에 대하여
\begin{align*}
    \dD_{\vec v}^3 f &:= \dD_{\vec v} \bigl(\dD_{\vec v}^2 f\bigr)\\
                     &= (a \dD_1 + b \dD_2) \bigl(a^2 \dD_1^2 f + 2ab \dD_1 \dD_2 f + b^2 \dD_2^2 f\bigr)\\
                     &= a^3 \dD_1^3 f + 3a^2 b \dD_1^2 \dD_2 f + 3ab^2 \dD_1 \dD_2^2 f + b^3 \dD_2^3 f
\end{align*}
이다.

\subsection{테일러 전개와 근삿값 이론}

\begin{definition}
    함수 $f(x_1, \dots, x_n)$가 정의역의 한 점 $P$에서 미분가능하다고 하자.
    이때 벡터 $\vec v$의 크기가 작으면,
    \begin{equation*}
        f(P + \vec v) \approx f(P) + \grad f(P) \cdot \vec v
    \end{equation*}
    이다.
    여기에서
    \begin{equation*}
        f(P) + \grad f(P) \cdot \vec v
    \end{equation*}
    를 점 $P$에서 $f(P + \vec v)$의 일차근삿값이라고 부른다.
\end{definition}

\begin{theorem}[테일러 정리]
    $n$-공간의 열린집합 $U$에서 정의된 $k$번 미분가능한 함수 $f$가 주어져 있다.
    이때 $U$의 한 점 $P$와 벡터 $\vec v$에 대하여 선분 $[P, P + \vec v] := \{P + t \vec v \mid 0 \leq t < 1\}$이 $U$에 포함된다고 하자.
    그러면 등식
    \begin{equation*}
        f(P + \vec v) = f(P) + \dD_{\vec v} f(P) + \frac{1}{2!} \dD_{\vec v}^2 f(P) + \dots + \frac{1}{(k - 1)!} \dD_{\vec v}^{k - 1} f(P) + \frac{1}{k!} \dD_{\vec v}^k f(P + t^* \vec v)
    \end{equation*}
    를 만족시키는 $t^*$가 $0$과 $1$ 사이에 존재한다.
\end{theorem}

\begin{proof}
    도움정리~\ref{lem:second_ord}에서 살표보았듯이, 함수
    \begin{equation*}
        g(t) := f(P + t \vec v)
    \end{equation*}
    에 대하여
    \begin{equation*}
        g^{(i)}(t) = \dD_{\vec v}^i f(P + t \vec v), \quad i = 0, 1, \dots, k
    \end{equation*}
    임을 귀납법을 사용하여 알 수 있다.

    먼저 $i = 0$일 때는 당연히 성립함을 알 수 있다.
    그리고 귀납법 가정에 의하여
    \begin{equation*}
        g^{(i + 1)}(t) = \diff*{\bigl(\dD_{\vec v}^i f\bigr)}{t} (P + t \vec v) = \bigl(\dD_{\vec v} \bigl(\dD_{\vec v}^i f\bigr)\bigr)(P + t \vec v)
    \end{equation*}
    이므로 원하는 결론을 얻는다.

    이제 $g(t)$에 일변수 테일러 전개를 응용하면
    \begin{equation*}
        g(t) = g(0) + g'(0) t + \dots + \frac{g^{k - 1}(0)}{(k - 1)!} t^{k - 1} + \frac{g^{(k)}(t^*)}{k!} t^k
    \end{equation*}
    을 만족시키는 $t^* \in (0, t)$의 존재를 안다.
    여기서 $t = 1$로 두면 증명이 끝난다.
\end{proof}

\subsubsection{근사다항식과 잉여항}

\begin{definition}
    $n$-공간의 점 $P$ 근방에서 정의된 $k$급 함수 $f(X)$에 대하여
    \begin{equation*}
        T_k f(P, \vec v) := f(P) + \dD_{\vec v}f(P) + \dots + \frac{1}{k!} \dD_{\vec v}^k f(P)
    \end{equation*}
    를 점 $P$에서 $f(P + \vec v)$의 $k$차 근삿값이라고 부른다.
\end{definition}

위 식에서 $\vec v = X - P = (x_1 - p_1, \dots, x_n - p_n)$로 두면
\begin{equation*}
    X \mapsto T_k f(P, X - P)
\end{equation*}
는 점 $P$에서 $f(X)$의 $k$차 근사(다항)식이다.

\paragraph{잉여항}
\begin{definition}
    함수 $f$의 테일러 전개에서
    \begin{equation*}
        R_k f(P, \vec v) := f(P + \vec v) - T_k f(P, \vec v)
    \end{equation*}
    를 $k$차 잉여항 또는 $k$차 나머지항이라고 부른다.
\end{definition}

\begin{corollary} \label{cor:residue}
    $n$-공간의 열린집합 $U$에서 정의된 이급함수 $f$와 $U$에 포함되는 선분 $\{P + t \vec v \mid 0 \leq t \leq 1\}$에 대하여
    \begin{equation*}
        M_2 := \max \{|\dD_i \dD_j f(P + t \vec v)| \mid 1 \leq i, j \leq n,\ 0 \leq t \leq 1\}
    \end{equation*}
    이라 하자.
    그러면 $f$의 일차 잉여항 $R_1 f(P, \vec v)$는 부등식
    \begin{equation*}
        |R_1 f(P, \vec v)| \leq \frac{M_2}{2} (|v_1| + \dots + |v_n|)^2
    \end{equation*}
    을 만족시킨다.
\end{corollary}

\begin{proof}
    생략.
\end{proof}

\begin{corollary}
    따름정리~\ref{cor:residue}에서 $f$가 $k + 1$급 함수라고 하면, 등식
    \begin{equation*}
        R_k f(P, \vec v) = \frac{1}{(k + 1)!} \dD_{\vec v}^{k + 1} f(P^*)
    \end{equation*}
    을 만족시키는 $P^* \in [P, P + \vec v]$가 존재한다.
    이때
    \begin{align*}
        M_{k + 1} &:= M_{k + 1} f(P, \vec v)\\
                  &:= \max \{|\dD_{i_0} \dots \dD_{i_k} f(P + t \vec v)| \mid 1 \leq i_0, \dots, i_k \leq n,\ 0 \leq t \leq 1\}
    \end{align*}
    로 두면
    \begin{equation*}
        \bigl|D_{\vec v}^{k + 1} f(P^*)\bigr| \leq M_{k + 1} (|v_1| + \dots + |v_n|)^{k + 1}
    \end{equation*}
    이다.
    특히 다음 부등식을 얻는다:
    \begin{equation*}
        |R_k f(P, \vec v)| \leq M_{k + 1} \frac{(|v_1| + \dots + |v_n|)^{k + 1}}{(k + 1)!}.
    \end{equation*}
\end{corollary}

위 정리의 마지막 식에서 $\lim_{\vec v \rightarrow \vecz} \frac{(|v_1| + \dots + |v_n|)^{k + 1}}{|\vec v|^k} = 0$이므로 다음 정리는 $f$가 $k + 1$급 함수일 때에는 자명하고, $k$급일 때에는
\begin{equation*}
    R_k f(P, \vec v) = R_{k - 1} f(P, \vec v) - \frac{1}{k!} \dD_{\vec v}^k f(P) = \frac{1}{k!} \bigl(\dD_{\vec v}^k f(P^*) - \dD_{\vec v}^k f(P)\bigr) = o(|\vec v|^k)
\end{equation*}
이므로 다음을 얻는다.

\begin{corollary}
    $k$급 함수 $f$에 대하여 점 $P$에서 $k$차 잉여함수
    \begin{equation*}
        \vec v \mapsto R_k f(P, \vec v)
    \end{equation*}
    는 $o(|\vec v|^k)$이다.
\end{corollary}

\subsubsection{테일러 전개의 유일성}

\begin{theorem}[테일러 전개의 유일성]
    함수 $f$가 $n$-공간의 한 점 $P$ 근방에서 정의된 $k$급 함수이면, 등식
    \begin{equation*}
        f(P + \vec x) = T_x (\vec x) + R_k (\vec x) \quad (|\vec x| \ll 1)
    \end{equation*}
    를 만족시키는 차수가 $k$ 이하인 다항식 $T_k(\vec x)$와 $o(|\vec x|^k)$인 함수 $R_k(\vec x)$가 각각 유일하게 존재한다.
\end{theorem}
\begin{proof}
    생략.
\end{proof}

\subsection{임계점 정리}
\subsubsection{최대점과 최소점}

\begin{definition}
    주어진 실숫값 함수에 대하여 정의역의 점 중에서 함숫값이 최대인 점을 그 함수의 최대점이라 한다.
    즉, 점 $P$가 함수 $f: U \rightarrow \mathbb R$의 최대점이라는 것은 $P \in U$이고, $U$의 임의의 점 $Q$에 대하여
    \begin{equation*}
        f(P) \geq f(Q)
    \end{equation*}
    라는 뜻이다.
    함수의 최대점에서 함숫값을 그 함수의 최댓값이라고 한다.

    마찬가지로, 주어진 실숫값 함수에 대하여 정의역의 점 중에서 함숫값이 최소인 점을 그 함수의 최소점이라 한다.
    즉, 점 $P$가 함수 $f: U \rightarrow \mathbb R$의 최소점이라는 것은 $P \in U$이고, $U$의 임의의 점 $Q$에 대하여
    \begin{equation*}
        f(P) \leq f(Q)
    \end{equation*}
    라는 뜻이다.
    함수의 최소점에서 함숫값을 그 함수의 최솟값이라고 한다.
\end{definition}

\subsubsection{극점}
\begin{definition}
    주어진 실숫값 함수에 대하여 함숫값이 국소적으로 최대인 점을 극대점이라 하고, 국소적으로 최소인 점을 극소점이라 한다.
    극대점과 극소점을 통틀어 극점이라고 부른다.
    극대점에서의 함숫값과 극소점에서의 함숫값을 각각 극댓값, 극솟값이라고 부른다.
    또 극점에서의 함숫값을 극값이라고 한다.
\end{definition}

\subsubsection{임계점}
\begin{definition}
    $n$-공간의 열린 집합에서 정의된 미분가능한 함수 $f$에서 모든 방향미분계수가 영인 점을 함수 $f$의 임계점이라고 부른다.
\end{definition}

\begin{theorem}[임계점 정리]
    $n$-공간의 열린 집합에서 정의된 미분가능한 함수의 극점은 임계점이다.
\end{theorem}

\subsection{헤세 판정법}
\subsubsection{안장점}

\begin{theorem}
    임계점이지만 극점이 아닌 점을 안장점이라고 한다.
\end{theorem}

\subsubsection{헤세 행렬}

\begin{definition}
    이급함수 $f(x_1, \dots, x_n)$에 대하여, 정의역의 점 $P$에서의 이계 편미분계수들로 이루어진 $n \times n$차 행렬
    \begin{equation*}
        f''(P) := \bigl(\dD_i \dD_j f(P)\bigr) = \left(\diffp{f}{x_i, x_j}(P)\right)_{1 \leq i, j \leq n}
    \end{equation*}
\end{definition}

\subsubsection{행렬의 음양}

\begin{definition}
    이차 대칭행렬 $A = \begin{pmatrix}a & b\\b & c\end{pmatrix}$에서
    \begin{enumerate}
        \item $ac - b^2 > 0$이고 $a > 0$일 때, $A$를 양행렬이라 하고 $A > O$으로 쓴다.
        \item $ac - b^2 > 0$이고 $a < 0$일 때, $A$를 음행렬이라 하고 $A < O$으로 쓴다.
    \end{enumerate}
\end{definition}

\begin{lemma}
    대칭행렬 $A = \begin{pmatrix}a & b\\b & c\end{pmatrix}$에 대응되는 이차형식
    \begin{equation*}
        q(x, y) = ax^2 + 2bxy + cy^2 = \begin{pmatrix}x & y\end{pmatrix} A \begin{pmatrix}x\\y\end{pmatrix}
    \end{equation*}
    에 대하여
    \begin{enumerate}
        \item $A > O$이면, 원점 $(0, 0)$은 $q(x, y)$의 최소점이다.
        \item $A < O$이면, 원점 $(0, 0)$은 $q(x, y)$의 최대점이다.
        \item $\det A < O$이면, 원점 $(0, 0)$은 $q(x, y)$의 안장점이다.
    \end{enumerate}
\end{lemma}

\begin{proof}
    생략.
\end{proof}

\begin{theorem}[헤세 판정법]
    좌표평면의 열린집합에서 정의된 이급함수 $f(x, y)$는 임계점 $P$에서
    \begin{enumerate}
        \item $f''(P) > O$이면, $P$는 극소점이다.
        \item $f''(P) < O$이면, $P$는 극대점이다.
        \item $\det f''(P) < O$이면, $P$는 안장점이다.
    \end{enumerate}
\end{theorem}

\begin{proof}
    생략.
\end{proof}
\end{document}
